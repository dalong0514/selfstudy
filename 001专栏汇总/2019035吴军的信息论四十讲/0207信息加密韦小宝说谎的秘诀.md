# 0207. 信息加密：韦小宝说谎的秘诀

吴军·信息论 40 讲

2019-06-20

进入课程 >

25｜信息加密：韦小宝说谎的秘诀

12:12 11.17 MB

转述：宝木

你好，欢迎来到我的《信息论 40 讲》。

金庸小说中的韦小宝谎话连篇，但居然有不少人信，很多人就觉得这是金庸瞎编的。但是从信息论的角度来分析一下，这个现象背后还是有一些道理的。我们先来看看韦小宝这个人的行为。

韦小宝说谎的第一个要诀是：说话九句真，一句假。由于有九句是真话，因此大家对他有一个基本信任，否则要是 100% 讲假话那就没人信了。

韦小宝的这个做法，就给对方出了一个难题，就是要不要信他的话？如果完全不相信，可能错失一两次机会，当然如果相信也可能被骗有损失。

当然，稍微谨慎一点的人，会想办法从侧面验证韦小宝说话的真假，比如康熙的信息渠道多，经常能识破他的谎话。但是并非任何时候人们都有机会来验证，比如他通知兄弟们逃跑，那时就没有时间去验证，要么信他，要么不信。

这在其实就利用了信息论密码传输中的一个实用性原则，也就是保证一定的时间内密码有效就可以，比如我们认定比特币协议是安全的，其前提条件是，以现有的计算能力，我们无法在有限的时间里破解它。

同样的，由于无法在短时间里验证韦小宝话的真假，因此大家就要算一算，到底是收益大还是损失大。因为他 9 句真 1 句假，让人感觉可能还是收益大，于是很多人就信了。

韦小宝说谎的第二个要诀，就是同样的理由不用两次，这就符合加密中一次性密码永远无法破译的原则。

此外，韦小宝在传递信息的时候，无意中还使用了加密最基本的原则，就是第三方截获加密信息后，不会获得比先前更多的信息。

有一次韦小宝想通知康熙，有人要刺杀他，画了一幅画，中间是个圆圈，边上是一把刀指向圆圈。他的解释是，让人准备刻花汤圆给大家吃，暗含的意思是有人要刺杀小元子。他没读过书，玄和元分不清，而小玄子是他私下里对康熙的称谓，只有他和康熙两个人知道。别人即使拿到这个密诏，也看不懂。

故事讲完了，我们现在从信息论的角度出发，谈谈加密的本质。

假如我们有一个原始信息 I（大写的 i），我们对它进行编码，变成 C，C 是所有人都可以读懂的，因此我们称之为明文。当然传输明文 C 是极不安全的，因此我们就对它进行加密，得到密文 E，而使用的密码则是 K。

加密的目的是什么呢？当敌方获得密文 E 之后，对明文 C 的知晓程度不会增加。换句话说，如果敌方对原始信息 I 的知晓程度原来是 10%，拿到密文 E 之后还是 10%。

当然，在信息论中我们采用的是信息熵 H 来衡量对方的知晓程度，或者反过来说，对方对这个信息的不确定程度。

比如我方一支部队可能从南边行军，也可能从北边走，我们要通知友军自己的行军路线。假定敌方原本对这件事的不确定性是 H=1 比特，也就是 50% vs 50%，截获了加密信息后，不确定性依然是 H=1 比特，那么加密就成功了。如果截获了密码，破译了，变成了明码，敌方就得知了行军路线，不再有不确定性了，于是 H=0 了。

因此，加密的原则必须是，当对方收到由密码写的密文后，无法降低任何不确定性。比如，韦小宝画的那张谁也看不懂的图，就符合这个要求。

那么怎样才能让密码在最大程度上做到信息不泄密呢？从上述原理可以看出，就是要将原本有规律的信息，变成看似毫无规律，随机分布的编码。这时候，无论敌方怎么处理收到的密码，获得的信息都近乎为零。

但是，做到将原本有规律的信息随机化这件事，说起来容易做起来难，因为它不是真的随机的，而是伪随机的，是让敌方觉得是随机，而我方其实知道背后的算法或编码原则。如果说真的随机，我方自己也读不出原来的信息了。

所谓伪随机，就是用一个算法产生的随机序列。比如我问你，下面的数字序列是否是随机的：445923078164062862。

你的第一感觉是，它一定是，但其实它不是，它只是从圆周率 Pi 中截取的一段。如果敌方知道了我的随机算法是按照某种规律截取 Pi 中的序列，我加密的密文就被破译了。

在信息论出现之前，数学家们已经开始懂得要增加随机性这个原理，但是做法上却非常简陋。

比如用某一本书的页码和字的位置做编码。我们经常在谍战片中看到间谍们要竭尽全力搜寻对方的母本，其实就是这么一个保留了编码原则的书，找到了就很容易破译。有了信息论之后，加密就有了理论指导，因此二战后的密码被破译的就不多了。想更多信息加密相关知识的同学可以参阅「得到」里卓克老师的《密码学》课程。

那么是否有永远无法破解的加密呢？有的，那就是使用一次的加密密码。为什么一次性加密无法破译呢？为了说明这一点，我们先说说为什么重复使用的密码不安全。

我们可以把加密的过程看成是这样的：明文 + 密码 = 密文。

在加密的过程中如果给定明文和密码，你一定能得到唯一的密文；但是对于破密的人来讲，这个过程的逆过程非常困难，也就是说给你最后的密文，你是无法倒推出明文和密码的。

这就如同 3+5=8，但是你拿着 8 这个数，想知道它是哪两个数相加而来的，那就很难，因为可能性太多，不仅 3+5=8，2+6 也等于 8。

那么破密是怎么进行的呢？从原理上讲，如果一个密码重复使用，某些明文和密文的对应恰好又不小心被泄露了，对方就可能倒推出密码，于是整个密码系统都被破解。虽然在密码破译之前很难找到明文和密文的对应，使得密码在一段时间里是安全的，但是对方可以设计圈套，获得这种对应。

比如，二战时在中途岛海战之前，美军截获的日军密电经常出现 AF 这样一个地名，应该是太平洋的某个岛屿，但是美军无从知道是哪个。于是，美军就逐个发布与自己控制的岛屿有关的假新闻。

当美军发出「中途岛供水系统坏了」这条假新闻后，从截获的日军情报中又看到含有 AF 的电文（日军的情报内容是 AF 供水出了问题），美军就断定中途岛就是 AF。事实证明美军判断正确，于是在那里成功地伏击了日本联合舰队，并一举扭转了太平洋战争的战局。

但是，如果密码只用一次，就不会有这个问题，以后的加密不会因为一次失误泄露而被破解。

这一点香农在信息论中表述得清清楚楚。我们说量子通信是安全的，就是因为它是使用一次性密码。关于量子通信，大家可以回顾《科技史纲 60 讲》第 59 讲。

我们一开始说韦小宝撒谎不容易被揭穿的第二个要诀，就是因为他每次使用不同的理由。当然我们不是要教大家撒谎，而是从这一点出发告诉大家保护自己隐私的技巧。

首先，密码要经常替换，而且最好不同的网站使用不同的密码。当然密码多了，你可能记不住，一个简单的方法是把密码分为两部分，一部分是所有网站都固定的，另一部分是容易记忆的，不需要太长，你记得住的。

两部分拼起来即可，这是研究网络安全的专家推荐的办法。事实上，如果你起了一堆很难记住的密码，因为记不住，全写在了纸上，反而不安全。

其次，保护隐私的一个很好的办法，就是将隐私埋藏在随机的噪音中。

今天很多在线服务的电商（比如订酒店、机票）都存在着价格歧视的问题。对方通过你的网络行为了解你的意图，比如你总是在出门前两天订机票，你看到的价格就可能高于其他人。

但是如果你总是随意浏览价格，从不购买，就不会有这样的问题。因此一个可行的做法是经常删除你的上网记录（主要是 Cookie），然后将偶尔的购买行为放到大量随机的浏览中。

这就如同韦小宝十句真话夹杂着一句谎话。当然，这样做要费点时间。对于时间很宝贵，钱不是问题的人来讲，就不用花这个精力了。

最后，如果你想让人知道你的观点，就要明确表述。反之，你的表述就应该让对方得不到任何信息量，但也不要误导别人。

比如对方问你是否愿意支持他竞选学生会主席，你不想支持他，又不好明说。该怎么办呢？

如果他一开始对此的期望值是 7 成支持，你说出去的话，还应该让他维持这个期望值。如果你让他觉得是十成支持，回头你又不支持，这是误导他，过后他会翻脸。

反之，你发表你的看法后，让他觉得是三成支持，这是比较明确地表达了你的否定态度，他当场就会不高兴。如果你说了一大堆的话，维持了他事先的想法，这其实没有传递出任何的信息，是最不得罪人的做法。

要点总结

密码的精髓在于，对方拿到你的密文，得不到额外的信息。要让对方获得了密文后，也无法减少你传递的信息的不确定性。

保护自己隐私的办法也在于此。如果你不想给对方提供任何信息，最好的办法就是让他对你的猜测在得到你的信息前后不产生任何变化。

一次性密码最安全。虽然我们不能做到每次通信都更换密码，但是至少能够做到不同网站使用不同密码。当然，如果你要给人一个委婉推却的借口，最好每次找一个不同的理由。

思考题：你不想得罪朋友，又怕告诉他真相后他受不了，如何委婉地告诉他一个坏消息？

预告：接下来的两讲我会先带你回顾 1G—5G 的通信历史，然后再一起看看通信的未来发展趋势。我们下一讲再见。

